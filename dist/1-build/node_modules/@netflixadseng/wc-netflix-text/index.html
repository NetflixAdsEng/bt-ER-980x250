<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	

	

	<script type="text/javascript">
		
// GENERIC SOURCE TRACKER: wc-netflix-text
if (typeof module === 'undefined') { module = {}; }
module.exports = {
  "id": "43232d9b-3b05-4471-9dfe-d0f9815c0e0a",
  "name": "wc-netflix-text",
  "description": "A simple text component to allow dynamic binding",
  "type": "web_components",
  "context": "Default",
  "state": "published",
  "updated": 1532472910805,
  "full_name": "NetflixAdsEng/wc-netflix-text",
  "html_url": "https://github.com/NetflixAdsEng/wc-netflix-text",
  "username": "GitHub",
  "version": "4.0.3"
};!(function() {
  // remove any tags, replace <br> with \n and render back to innerHTML
  function safeBRReplace(str) {
    var frag = document.createDocumentFragment();
    frag.textContent = str.replace(/<br\s*\/?>/gm, '\n');
    return frag.textContent.replace(/\n/gm, '<br>');
  }

  if (document.registerElement) {
    var COMPONENT_NAME = 'netflix-text';

    var component = Object.create(HTMLElement.prototype, {
      createdCallback: {
        value: function() {
          var textSpan = document.createElement('span');
          this.appendChild(textSpan);
          this._attached = false;
          this._hasInited = false;
        }
      },
      detachedCallback: {
        value: function() {
          this._attached = false;
        }
      },
      attachedCallback: {
        value: function() {
          this._attached = true;

          if (this._hasInited) {
            return;
          }

          this._hasInited = true;

          var dom = this;
          var textSpan = this.children[0];

          var MonetComponent = document.querySelector('monet-integrator');
          if (MonetComponent) {
            MonetComponent.register(this);
            MonetComponent.getMonetData().then(function(data) {
              var bindSrc = dom.getAttribute('data-dynamic-key');
              if (bindSrc.split('.').length == 1) {
                bindSrc = 'rootAssets["text.' + bindSrc + '"].text';
              }

              try {
                var dynamicText = eval('data.' + bindSrc);
                if (dynamicText) {
                  textSpan.innerHTML = safeBRReplace(dynamicText);
                  textSpan.classList.add(Monet.getComponentLocale('text.' + dom.getAttribute('data-dynamic-key')).substr(0, 2));
                }

                dom.dispatchEvent(new CustomEvent('ready'));
              } catch (e) {
                console.error('Monet dynamic ID not found in JSON: ', bindSrc, 'trying backup');

                MonetComponent.getBackupMonetData().then(
                  function(backupData) {
                    if (backupData) {
                      var dynamicText = eval('backupData.' + bindSrc);
                      textSpan.innerHTML = safeBRReplace(dynamicText);
                      textSpan.classList.add(
                        Monet.getComponentLocale('text.' + dom.getAttribute('data-dynamic-key')).substr(0, 2)
                      );
                    }
                    dom.dispatchEvent(new CustomEvent('ready'));
                  },
                  function(error) {
                    console.error('Failed to load backup Monet data', error);
                  }
                );
              }
            });
          } else {
            console.warn('No "monet-integrator" component found. Dynamic binding is disabled');
          }
        }
      },

      preview: {
        value: function() {
          this.children[0].innerHTML = 'This is a preview of the text component.';
          // ensure the preview in C2.0 doesn't get cut off
          this.style.height = '40px';
          this.style.display = 'inline-block';
        }
      }
    });
    if (document.createElement(COMPONENT_NAME).constructor.__proto__ !== window.HTMLElement) {
      document.registerElement(COMPONENT_NAME, { prototype: component });
    }
  }
})();

	</script>
</head>

<body>
	<script>
		var component = document.createElement('netflix-text');
		component.preview();
		document.body.appendChild(component);
	</script>
</body>

</html>